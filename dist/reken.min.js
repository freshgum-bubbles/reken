"use strict";const rekenVersion="0.8.2";if("undefined"==typeof rkn_server_generated)var rkn_server_generated=!1;if("undefined"==typeof rkn_generate_code)var rkn_generate_code=!1;var setupFunction,controllerFunction,_setupString,_controllerString;let booleanAttrs=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","truespeed"];function buildClasses(a,b,c,d,e,f,g,h,j,k,l,m,n){if("TEMPLATE"==b.tagName)return;let o=Object.keys(b.dataset).sort();if(o.indexOf("data-component")){let a=!1;for(let c of o)c.startsWith("bind")&&(b.setAttribute("data-on1-"+c.substring(4),b.dataset[c]+"=e.detail.value"),a=!0);a&&(o=Object.keys(b.dataset).sort())}if(0<o.length){if(a){let a=["component"];for(let b of o)(0<b.startsWith("arg")||0<b.startsWith("bind"))&&a.push(b);for(let b of a){let a=o.indexOf(b);0<=a&&o.splice(a,1)}}else if(0<=o.indexOf("component")){let a=["component"];for(let b of o)(b.startsWith("arg")||b.startsWith("bind")||b.startsWith("action1")||b.startsWith("style1")||b.startsWith("class1")||b.startsWith("if1")||b.startsWith("on1")||b.startsWith("attr1")||b.startsWith("timer1")||b.startsWith("interval1")||b.startsWith("route1")||b.startsWith("rest1")||b.startsWith("rest-options1")||b.startsWith("calc1"))&&a.push(b);o=a}let i=[],p=["style1","if1","action1","on1","attr1","class1","component","style","if","for","calc","attrName","attrMin","attrMax","attrValue","value"];for(let a of p){let b=o.indexOf(a);0<=b&&(i.push(a),o.splice(b,1))}for(let a of o)i.push(a);let q="    ";for(let o of i){let p=b.dataset[o],r="";switch(""!=b.id&&"this.root"!=c&&c===d&&(c="document.getElementById('"+b.id+"')"),o){case"text":h.push(q+"_v = `"+p+"`;\n    if ("+c+".textContent !== _v)\n      "+c+".textContent = _v");break;case"html":h.push("_v=`"+p+"`;if ("+c+".innerHTML !== _v) "+c+".innerHTML = _v");break;case"value":if("checkbox"==b.type)b.hasAttribute("name")||b.hasAttribute("data-attr-name")?h.push(q+c+".checked = "+p+".indexOf("+c+".value) > -1"):h.push(q+c+".checked = "+p);else if("radio"==b.type)b.hasAttribute("name")||b.hasAttribute("data-attr-name")?h.push(q+c+".checked = "+p+" == "+c+".value"):h.push(q+c+".checked = "+p);else if("file"==b.type){let a=p.indexOf(":");0<=a&&(r=p.substring(a+1),p=p.substring(0,a))}else h.push(q+c+".value = "+p);let s="change";("TEXTAREA"===b.tagName||"range"===b.type)&&(s="input");let t="value_"+uniqueID();g.push(d+".dataset.event_"+"value"+" = '"+t+"'");const u=getEventContext(b);let v=p;if(u.forContext){const{forIterator:a,contextVar:b,idxName:c}=u.forContext;v==b+".item"&&(v=a+"["+c+"]")}j.push({elemId:void 0===e?d:e,eventType:s,handlerEventCheck:"  if (!isEventHandler(e.target, 'value', '"+t+"')) return;",handlerName:t,handlerCode:"file"===b.type?v+"=e.target.files[0];importData(e.target, ()=>{_mainInstance.controller({})}, "+r+")":v+"=typedReturn(e.target,"+v+");",forContext:"let ctxIdx = indexesInForAncestors(e.target);"+u.contextString+";",deferredUpdate:"file"===b.type});break;case"style1":if(a)break;case"style":h.push("_v=`"+p+"`;if ("+c+".getAttribute('style') !== _v) "+c+".setAttribute('style',  _v)");break;case"class1":if(a)break;case"class":const w=p.split(";");for(const a of w){let b,d;0<=a.indexOf(":")?(b=a.substring(0,a.indexOf(":")),d=a.substring(a.indexOf(":")+1)):b=d=a,h.push(c+".classList.toggle('"+b+"', "+d+")")}break;case"route1":if(a)break;case"route":{let[a,b]=parseIfExpression(p);p=a,p.startsWith("/")&&(l=[],p=p.substring(1));let c=p.split("/");0===c.length&&c.push(""),l=l.concat(c),p="reken_routing_path.length>="+l.length+"";for(let a=0;a<l.length;a++)if(l[a].startsWith("#")){let b=`let ${l[a].substring(1)} = reken_routing_path[${a}]`;0>h.indexOf(b)&&m.push(b)}else p+=`&&reken_routing_path[${a}] === '${l[a]}'`;b&&(p=b+":"+p)}case"if1":if(a)break;case"if":{let[a,d]=parseIfExpression(p);d?h.push(c+".classList.toggle('"+d+"', "+a+")"):(h.push("_v=("+p+"?'':'none');"),h.push("if ("+c+".style.display!==_v) "+c+".style.display=_v;")),b.dataset.for||void 0===b.dataset.if&&void 0===b.dataset.if1&&void 0===b.dataset.route||h.push("if ("+parseIfExpression(p)[0]+") {")}break;case"action1":if(a)break;case"action":{let a="click_"+uniqueID();g.push(d+".dataset.event_click = ("+d+".dataset.event_click??'')+'"+a+"'+':'"),j.push({elemId:void 0===e?d:e,eventType:"click",handlerEventCheck:"  if (!isEventHandler(e.target, 'click', '"+a+"')) return;",handlerName:a,handlerCode:p,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContext(b).contextString+";"})}break;case"timer1":if(a)break;case"timer":{const a=p.split(":");let f,[i,k]=a;if(2<a.length&&(f=a.slice(2).join(":")),"undefined"==typeof i||"undefined"==typeof k||"undefined"==typeof f)console.error(`data-timer: [${p}] incorrect amount of arguments`);else{let a="timer_"+uniqueID();g.push(d+".dataset.event_timer = '"+a+"'"),j.push({elemId:void 0===e?d:e,eventType:"timer",handlerEventCheck:"",handlerName:a,handlerCode:f,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContext(b).contextString+";"}),h.push(`{const _l = ${c}`),h.push(`if ((${k}) && !_l.hasOwnProperty('timerID')) _l.timerID = setTimeout(()=>{this.${a}({'target':_l});delete _l.timerID;_mainInstance.controller({})}, ${i})`),h.push(`if (!(${k}) && _l.hasOwnProperty('timerID')) {clearTimeout(_l.timerID); delete _l.timerID}}`)}}break;case"interval1":if(a)break;case"interval":{const a=p.split(":");let f,[i,k]=a;if(2<a.length&&(f=a.slice(2).join(":")),"undefined"==typeof i||"undefined"==typeof k||"undefined"==typeof f)console.error("data-interval: ["+p+"] incorrect amount of arguments");else{let a="interval_"+uniqueID();g.push(d+".dataset.event_interval = '"+a+"'"),j.push({elemId:void 0===e?d:e,eventType:"interval",handlerEventCheck:"",handlerName:a,handlerCode:f,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContext(b).contextString+";"}),h.push(`{const _l = ${c}`),h.push(`if ((${k}) && !_l.hasOwnProperty('intervalID')) _l.intervalID = setInterval(()=>{this.${a}({'target':_l});_mainInstance.controller({})}, ${i})`),h.push(`if (!(${k}) && _l.hasOwnProperty('intervalID')) {clearInterval(_l.intervalID); delete _l.intervalID}}`)}break}case"for":void 0===e&&(e=c),g.push(d+".dataset.leafCount="+b.children.length),(void 0!==b.dataset.if||void 0!==b.dataset.if1)&&0<b.children.length&&(h.push(q+"if ("+parseIfExpression(b.dataset.if)[0]+") {"),q="  "+q);let x=p.substring(0,p.indexOf(":")),y=p.substring(p.indexOf(":")+1),z="_arr_"+uniqueID();isNaN(y)?h.push(q+"let "+z+" = (typeof ("+y+") !== \"number\"?"+y+": new Array(parseInt("+y+")))"):h.push(q+"let "+z+" = new Array(parseInt("+y+"))"),h.push(q+"updateForChildren("+c+","+z+", "+b.children.length+")");let A="rkn_forElem_"+uniqueID(),B="rkn_counter_"+uniqueID();h.push(q+"for (let "+B+"=0;"+B+"<"+c+".children.length/"+b.children.length+";"+B+"++){"),h.push(q+"if ("+B+">="+z+".length) break;"),h.push(q+"let "+x+"= {index:"+B+", item:"+z+"["+B+"]}"),n+=(""==n?"":",")+x,h.push(q+"let "+A);let C=0;for(let a of b.children)h.push(q+A+" = "+c+".children["+B+"*"+b.children.length+"+"+C+"]"),buildClasses(!1,b.children[C],A,d+".children["+C+"]",e,f,g,h,j,k,l,m,n),C++;h.push(q+"}// End loop "+B),(void 0!==b.dataset.if||void 0!==b.dataset.if1)&&0<b.children.length&&(q=q.substring(2),h.push(q+"}"));break;case"calc1":if(a)break;case"calc":"SCRIPT"===b.tagName?h.unshift(b.textContent.trim()):h.push("elem = "+c+";"+p+";");break;case"component":e=void 0;let i=p;if(!generatedClass[p]||!generatedClass[p+"_static"]||"true"==b.dataset.hasSlot||""!=n){let a=[],c=[],d=[];if(buildClasses(!0,b,"this.root","this.root",e,f,a,c,d,k,l,m,n),void 0===b.dataset.for){let g=0;for(let h of b.children){buildClasses(!1,h,"this.root.children["+g+"]","this.root.children["+g+"]",e,f,a,c,d,k,l,m,n),g++}void 0!==b.dataset.if&&c.push("}")}if(!generatedClass[p]){const[b,e]=generateComponentClass(p,p,a,c,d,m,"");k.push(...e),f.push(...b),f.push(`classRegistry['${i}']=${i.replace("-","_")}`),generatedClass[i]=!0}if("true"==b.dataset.hasSlot||""!=n){i=p+"_"+uniqueID();const[b,e]=generateComponentClass(i,p,a,c,d,m,n);f.push(...b),f.push(`classRegistry['${i}']=${i.replace("-","_")}`),generatedClass[i]=!0}else if("_main"!==p&&(i=p+"_static",!generatedClass[i])){const[b,e]=generateComponentClass(i,p,a,c,d,m,n);f.push(...b),f.push(`classRegistry['${i}']=${i.replace("-","_")}`),generatedClass[i]=!0}}else i=p+"_static";b.dataset.className=i,g.push(`    ${d}.rkn_class = new ${i.replace("-","_")}(${d})`),h.push("    {");let D=[];for(let a of Object.keys(b.dataset))if(a.startsWith("arg")||a.startsWith("bind")){let c=a.substring(3).toLowerCase();a.startsWith("bind")&&(c=a.substring(4).toLowerCase());let d=b.dataset[a],e=uniqueID();/^[a-zA-Z_$][0-9a-zA-Z_$.]*$/.test(d)?h.push("      let "+e+" = (typeof "+d+"!== 'undefined' && "+d+" !== window['"+d+"']?"+d+":'"+d+"')"):isNaN(d)?h.push("      let "+e+" = `"+d+"`"):h.push("      let "+e+" = "+d),D.push(`${c}:${e}`)}let E=D.join(",");0<D.length&&(E+=","),E+=n,h.push(`      ${c}.rkn_class.controller({${E}})`),h.push("    }");break;case"rest1":if(a)break;case"rest":let F=p.substring(0,p.indexOf(":")),G=p.substring(p.indexOf(":")+1),H="",I=G.indexOf(":");0<I&&!G.startsWith("http")&&(H="."+G.substring(0,I),G=G.substring(I+1));let J="{}";b.dataset.restOptions&&(J=b.dataset.restOptions),b.dataset.restOptions1&&(J=b.dataset.restOptions1),h.push("    processRestCall("+c+",`"+G+"`, "+J+", (js)=>{ if (this instanceof _main) "+F+"=js"+H+"; else this."+F+"=js"+H+";_mainInstance.controller({})})");break;default:if(o.startsWith("attr")||o.startsWith("attr1")&&!a){let a=capCharToHyphen(o.substring(o.startsWith("attr1")?5:4));booleanAttrs.includes(a.toLowerCase())?h.push("if ("+p+"){"+c+".setAttribute('"+a+"', `"+p+"`)}else{"+c+".removeAttribute('"+a+"')}"):h.push("if ("+c+".getAttribute('"+a+"') !== `"+p+"`) "+c+".setAttribute('"+a+"', `"+p+"`)")}else if(o.startsWith("on")||o.startsWith("on1")&&!a){let a=o.substring(o.startsWith("on1")?3:2).toLowerCase(),c=p,f=a+"_"+uniqueID();g.push(d+".dataset.event_"+a+" = '"+f+"'"),j.push({elemId:void 0===e?d:e,eventType:a,handlerEventCheck:"  if (!isEventHandler(e.target, '"+a+"', '"+f+"')) return;",handlerName:f,handlerCode:c,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContext(b).contextString+";"})}}}}if(!b.dataset.component&&!b.dataset.for){let a=0;for(let i of b.children)buildClasses(!1,i,c+".children["+a+"]",d+".children["+a+"]",e,f,g,h,j,k,l,m,n),a++;(void 0!==b.dataset.if||void 0!==b.dataset.route)&&h.push("} else {disableTimers("+c+")}")}else null==b.dataset.if1||a||h.push("} else {disableTimers("+c+")}")}function capCharToHyphen(a){let b="";for(const c of a)c.match(/[a-z]/i)&&c===c.toUpperCase()&&0<b.length&&(b+="-"),b+=c.toLowerCase();return b}const processComponentReferences=a=>{if("TEMPLATE"!=a.tagName&&"component"in a.dataset){let b=getComponent(a.dataset.component);if(null!=b){for(let b of a.children)processComponentReferences(b);let c=b.querySelector("slot");if(null!=c&&0<a.childNodes.length){b.dataset.hasSlot="true";let d=c;for(let b,e=a.childNodes.length-1;0<=e;e--)b=a.childNodes[e],c.parentElement.insertBefore(b,d),d=b;c.parentElement.removeChild(c)}let d=["data-action","data-style","data-class","data-if","data-timer","data-interval","data-route","data-rest","data-rest-options","data-calc"];for(let c of a.getAttributeNames()){if(0<=d.indexOf(c)){b.setAttribute(c+"1",a.getAttribute(c));continue}if(c.startsWith("data-on")){b.setAttribute("data-on1"+c.substring(7),a.getAttribute(c));continue}if(c.startsWith("data-attr")){b.setAttribute("data-attr1"+c.substring(9),a.getAttribute(c));continue}null==b.getAttribute(c)?null!=a.getAttribute(c)&&b.setAttribute(c,a.getAttribute(c)):((c.startsWith("data-arg")||c.startsWith("data-bind"))&&b.setAttribute(c,a.getAttribute(c)),"class"==c&&b.classList.add(a.getAttribute("class")))}a.parentElement.replaceChild(b,a)}}else for(let b of a.children)processComponentReferences(b)};let componentRegistry={},classRegistry={},generatedClass={};const getComponent=a=>{let b=componentRegistry[a];if(b===void 0){let c=document.querySelector(`template[data-component='${a}']`);if(null==c||null==c.content||0==c.content.children.length)return console.error(`Component ${a}: no component definition found`),null;for(let a of c.content.children)if("STYLE"!==a.tagName&&"SCRIPT"!==a.tagName){b=a;break}processComponentReferences(b),b.setAttribute("data-component",a),componentRegistry[a]=b}let c=b.cloneNode(!0);return c};function generateComponentClass(a,b,c,d,e,f,g){let h=document.querySelector("template[data-component='"+b+"']");const i=a==b||"_main"==a;let j=[];const[k,l]=getStateVars(h);k.push("root");const m=getInitParams(h,"arg"),n=getInitParams(h,"bind"),o=n.map(a=>a.substring(0,a.indexOf("="))),p=[...m,...n],q=p.map(a=>a.substring(0,a.indexOf("="))),[r,s]=getMethods(h,k,p);if(j.push("//=============================================================================="),j.push(`class ${a.replace("-","_")} extends ${i?"rkn_base":b.replace("-","_")} {`),i&&"_main"!=a){j.push(...s),j.push("  constructor(root) {"),j.push("  super(root)"),j.push("    this.root = root;"),j.push(...l);for(let a of k)j.push(`    this.${a} = ${a}`);return j.push("  }"),j.push("  }"),[j,getStyle(h)]}j.push("  constructor(root) {"),j.push("  super(root)"),j.push("    this.root = root;"),j.push(...c);for(let h of e)j.push("    "+h.elemId+".addEventListener('"+h.eventType+"', event => this."+h.handlerName+"(event))");j.push("  }"),j.push("  static createInstance(elem) {"),j.push(`    return new ${a.replace("-","_")}(elem);`),j.push("  }");let t=p.join(",");0<p.length&&(t+=","),t+=g,j.push(`  controller({${t}}) {`);for(let h of k)j.push(`    let ${h} = this.${h}`);for(let h of r)j.push(h);if("_main"===a)for(let a of f)j.push("    "+a);j.push(...getScript(h)),0<d.length&&(j.push("    let _v, elem"),j.push(...d));for(let h of p){let a=h.substring(0,h.indexOf("="));j.push("    this."+a+" = "+a)}for(let h of k)j.push(`    this.${h} = ${h}`);j.push("  }");for(let h of e){j.push("  "+h.handlerName+"(e) {"),j.push("  "+h.handlerEventCheck);for(let a of k)j.push(`    let ${a} = this.${a}`);for(let a of q)j.push("    let "+a+" = this."+a);for(let a of f)j.push("    "+a);for(let a of r)j.push(a);j.push("    "+h.forContext),j.push("    "+h.handlerCode);for(let a of o)j.push("    if ("+a+"!==this."+a+") root.dispatchEvent(new CustomEvent('"+a+"', {detail:{'value':"+a+"},bubbles: true}))");for(let a of k)j.push(`    this.${a} = ${a}`);h.deferredUpdate||"timer"===h.eventType||"interval"===h.eventType||j.push("    _mainInstance.controller({})"),j.push("  }")}return j.push("}"),[j,getStyle(h)]}function getStateVars(a){let b=[],c=[];if(a){let d=a.content.querySelector("script");if(null!=d&&!d.hasAttribute("data-calc")&&0<d.childNodes.length){let a=d.textContent.split(/\r?\n/);for(let d of a){if(d=d.trim(),d.startsWith("function"))break;if(""==d||!d.startsWith("let"))continue;c.push("    "+d);let a=d.split(/=? /),e=a[1];b.push(e)}}}return[b,c]}function getMethods(a,b,c){let d=["    let dispatch = (type, content)=>this.dispatch(type, content)"],e=[],f=!0;if(a){let g=a.content.querySelector("script");if(null!=g&&!g.hasAttribute("data-calc")&&0<g.childNodes.length){let a=g.textContent.split(/\r?\n/);for(let g of a){if(g=g.trim(),g.startsWith("function")){f=!1,g=g.substring(8);let a=g.substring(0,g.indexOf("(")).trim(),h=g.substring(a.length+1,g.indexOf(")")+1).trim();e.push("  "+g.trim());for(let a of b)e.push(`    let ${a} = this.${a}`);for(let a of d)e.push("  "+a);for(let a of c){let b=a.substring(0,a.indexOf("="));e.push("  let "+b+" = this."+b)}d.push(`let ${a} = ${h}=>this.${a}${h}`);continue}f||e.push("    "+g)}}}return[d,e]}function getInitParams(a,b,c=!0,d="="){let e=[];if(a)for(let f of Object.keys(a.dataset))if(f.startsWith(b)){let g=f.substring(b.length).toLowerCase();if(c){let b=a.dataset[f];g+=""==b?`${d}undefined`:`${d}${isNaN(b)?"'"+b+"'":b}`}e.push(g)}return e}function getStyle(a){if(a&&a.content.querySelector("style")){let b=a.content.querySelector("style");if(null!=b&&b.textContent){let c=a.dataset.component,d=b.textContent.split(/\r?\n/);for(let a=0;a<d.length;a++)if(0<d[a].indexOf("{")){let b=d[a].indexOf(":host");0<=b&&(d[a]=d[a].substring(b+5));let e=d[a].trim();0>".#[:".indexOf(e[0])&&(e=" "+e),d[a]=`[data-component=${c}]`+e}return d}}return[]}function getScript(a){if(a&&a.content.querySelector("script[data-calc]")){let b=a.content.querySelector("script[data-calc]");if(null!=b&&b.textContent){let a=b.textContent.split(/\r?\n/);return a}}return[]}function getEventContext(a,b){"undefined"==typeof b&&(b={},b.idx=0,b.contextString="");let c=a.parentElement;if(null!=c&&(getEventContext(c,b),"undefined"!=typeof c.dataset.for)){b.forContext=getForContext(c);const a="ctxIdx["+b.idx++ +"]";b.forContext.idxName=a;const{forIterator:d,contextVar:e}=b.forContext;let f="let "+e+"= {index:"+a+"};";return f+="if (typeof ("+d+") !== 'number' && typeof ("+d+") !== 'undefined')"+e+"['item'] = "+d+"["+a+"];",b.contextString+=f,b}return b}function getForContext(a){let b=a.dataset.for,c=b.substring(0,b.indexOf(":")),d=b.substring(b.indexOf(":")+1);return{forIterator:d,contextVar:c}}const parseIfExpression=a=>{let b=null,c=a;return 0<=a.indexOf(":")&&(b=a.substring(0,a.indexOf(":")),c=a.substring(a.indexOf(":")+1)),[c,b]};var _ID=0;function uniqueID(){return"rkn"+_ID++}function substituteShortHandComponentNames(a,b){const c=b.dataset.component;return a.querySelectorAll(c).forEach(a=>{let d="DIV";for(const c of b.content.children)if("SCRIPT"!=c.tagName&&"STYLE"!==c.tagName){d=c.tagName;break}const e=document.createElement(d);for(let c,d=a.attributes.length-1;0<=d;--d)if(c=a.attributes[d],b.hasAttribute("data-arg-"+c.name)){e.setAttribute("data-arg-"+c.name,a.getAttribute(c.name));continue}else if(b.hasAttribute("data-bind-"+c.name)){e.setAttribute("data-bind-"+c.name,a.getAttribute(c.name));continue}else{if(c.name.startsWith("data-attr")){const d=c.name.substring(10);if(b.hasAttribute("data-arg-"+d)){e.setAttribute("data-arg-"+d,a.getAttribute(c.name));continue}}e.attributes.setNamedItem(a.attributes[d].cloneNode())}let f;for(let b,c=a.childNodes.length-1;0<=c;c--)b=a.childNodes[c],0==e.childNodes.length?e.appendChild(b):e.insertBefore(b,f),f=b;e.setAttribute("data-component",c),a.parentElement.replaceChild(e,a)}),c}function processShortHandComponentNames(){let a=[];document.querySelectorAll("template[data-component]").forEach(b=>{a.push(substituteShortHandComponentNames(document,b)),document.querySelectorAll("template[data-component]").forEach(a=>{substituteShortHandComponentNames(a.content,b)})}),updateStyleSheetShortHandNames(a),a.sort((c,a)=>a.length-c.length)}function updateStyleSheetShortHandNames(a){document.querySelectorAll("head > style").forEach(b=>{const c=b.textContent.split("\n"),d=[];for(let e of c){if(0<=e.indexOf("{"))for(const b of a)for(let a=0;0<=a;)a=e.indexOf(b,a),0<=a&&((0==a||0<="\t ,>+~]".indexOf(e[a-1]))&&0<="\t ,.:{>+~[".indexOf(e[a+b.length])?(e=e.substring(0,a)+"[data-component="+b+"]"+e.substring(a+b.length),a+=("[data-component="+b+"]").length):a++);d.push(e)}b.textContent=d.join("\n")})}function processIncludes(a,b){const c=[];return a.querySelectorAll("div[data-include]").forEach(async a=>{let d=a.dataset.include;if(d){b&&!d.startsWith("/")&&(d=b+"/"+d);const e=fetch(d).then(a=>{if(a.ok)return a.text();throw Error(`${a.status} - ${a.statusText}`)}).then(c=>{a.innerHTML=c;const e=d.split("/");return 1<e.length&&(e.pop(),b=e.join("/")),processIncludes(a,b)}).catch(()=>{a.textContent=`File ${d} not found.`});c.push(e)}}),Promise.allSettled(c)}function processRestCall(a,b,c,d){if(c&&"undefined"!=typeof c.fetch){if(!1===c.fetch)return;c.fetch=!1}else{if(typeof a.dataset.url!==void 0&&a.dataset.url===b)return;a.dataset.url=b}a.classList.add("reken-rest-busy"),a.classList.remove("reken-rest-error","reken-rest-done");let e=!1;fetch(b,c).then(a=>{if(!a.ok&&304===!a.status)throw new Error(`Network response was not ok, code ${a.status} - ${a.statusText}`);if(304===a.status)return void(e=!0);if(c.response=a,c.transformer){let b=Promise.resolve(a.text());return b.then(a=>c.transformer(a,c))}return a.json()}).then(b=>{e||d(b),a.classList.add("reken-rest-done")}).catch(b=>{throw a.classList.add("reken-rest-error"),b}).finally(()=>{a.classList.remove("reken-rest-busy")})}function typedReturn(a,b){switch(a.type){case"checkbox":return a.getAttribute("name")?(a.checked&&0>b.indexOf(a.value)&&b.push(a.value),!a.checked&&-1<b.indexOf(a.value)&&b.splice(b.indexOf(a.value),1),b):a.checked;case"radio":return a.getAttribute("name")?a.value:a.checked;case"number":case"range":return a.valueAsNumber;case"file":return a.files[0];default:return a.value;}}function importData(a,b,c){let d=a.files[0],e=new FileReader;e.onload=function(f){let e=f.target.result;a.files[0].data=c?c(e,d):JSON.parse(e),b()},e.readAsText(d)}function indexesInForAncestors(a,b){var c=Math.floor;"undefined"==typeof b&&(b=[]);let d=a.parentElement;return null!=d&&(indexesInForAncestors(d,b),"undefined"!=typeof d.dataset.for&&b.push(c(indexOf(d.children,a)/d.dataset.leafCount))),b}function isEventHandler(a,b,c){const d="event_"+b;return a.dataset[d]&&0<=a.dataset[d].indexOf(c)?!(a.hasAttribute("disabled")||a.hasAttribute("readonly")):null!=a.parentElement&&isEventHandler(a.parentElement,b,c)}function indexOf(a,b){let c=0;for(let d of a){if(d===b)return c;c++}return-1}function updateForChildren(a,b,c){let d=a.children,e=d.length/c;if(0<e){let f=[];for(let a=0;a<c;a++)f[a]=d[a],f[a].removeAttribute("id"),f[a].querySelectorAll("[id]").forEach(a=>{a.removeAttribute("id")});for(let g=0;g<b.length;g++){let b;for(let h,i=0;i<c;i++)h=g*c+i,g<e?b=d[h]:(b=f[i].cloneNode(!0),initComponentElement(b),a.appendChild(b)),""!==b.style.display&&(b.style.display="")}let g=!0;for(let a=b.length;a<e;a++)for(let b,e=0;e<c;e++)if(b=a*c+e,"none"!==d[b].style.display)d[b].style.display="none",g&&0==disableTimers(d[b])&&(g=!1);else continue}}function disableTimers(a){let b=0;a.hasOwnProperty("intervalID")&&(clearInterval(a.intervalID),delete a.intervalID,b++),a.hasOwnProperty("timerID")&&(clearInterval(a.timerID),delete a.timerID,b++);let c=a.children;for(let d=0;d<c.length;d++)b+=disableTimers(c[d]);return b}let initComponentElement=a=>{if(void 0!==a.dataset.component)return void(void 0===a.rkn_class&&(a.rkn_class=classRegistry[a.dataset.className].createInstance(a)));for(let b of a.children)initComponentElement(b)};var reken_routing_path;processIncludes(document.body.parentElement).then(()=>{processShortHandComponentNames(),processComponentReferences(document.body.parentElement),init()});function init(){function a(a){let b=[];if(2<a.length){const c=a.substring(2);b=c.split("/")}return b.push(""),b}reken_routing_path=a(window.location.hash),window.addEventListener("hashchange",()=>{reken_routing_path=a(window.location.hash),document.body.parentElement.rkn_class.controller({})});{let a=[],b=["template {display:none !important;}"];if(document.body.parentElement.setAttribute("data-component","_main"),a.push("class rkn_base { dispatch(type, content){this.root.dispatchEvent(new CustomEvent(type, {detail:content}))}} "),buildClasses(!1,document.body.parentElement,"_r","_r",void 0,a,[],[],[],b,[],[],""),0<b.length){const a=document.querySelector("head");null==a&&(a=document.createElement("head"),document.body.parentElement.insertBefore(a,document.body));const c=document.createElement("style");c.textContent=b.join("\n"),a.appendChild(c)}a.push("let _mainInstance = _main.createInstance(document.body.parentElement)"),a.push("document.body.parentElement.rkn_class = _mainInstance"),a.push("document.body.dispatchEvent(new CustomEvent('rekeninitialized', {}))"),a.push("_mainInstance.controller({})"),a.push("document.body.dispatchEvent(new CustomEvent('rekenready', {}))");let c=a.join("\n"),d=new Function(c);d()}}const rekenForceCalculate=()=>{document.body.parentElement.rkn_class.controller({})};