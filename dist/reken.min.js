"use strict";if("undefined"==typeof rkn_server_generated)var rkn_server_generated=!1;if("undefined"==typeof rkn_generate_code)var rkn_generate_code=!1;var setupFunction,controllerFunction,_setupString,_controllerString;let booleanAttrs=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","truespeed"];function buildClasses(a,b,c,d,e,f,g,h,j,k){if("TEMPLATE"==b.tagName)return;let l=Object.keys(b.dataset).sort();if(a){let a=["component"];for(let b of l)(0<b.startsWith("arg")||0<b.startsWith("bind"))&&a.push(b);for(let b of a){let a=l.indexOf(b);0<=a&&l.splice(a,1)}}else if(0<=l.indexOf("component")){let a=["component"];for(let b of l)(b.startsWith("arg")||0<b.startsWith("bind"))&&a.push(b);l=a}let m=[],n=["component","style","if","for","attr-value"];for(let i of n){let a=l.indexOf(i);0<=a&&(m.push(i),l.splice(a,1))}for(let i of l)m.push(i);let o="    ";for(let l of m){let a=b.dataset[l],m="";switch(""!=b.id&&"this.root"!=c&&c===d&&(c="document.getElementById('"+b.id+"')"),l){case"text":h.push(o+"_v = `"+a+"`;\n    if ("+c+".textContent !== _v)\n      "+c+".textContent = _v");break;case"html":h.push("_v=`"+a+"`;if ("+c+".innerHTML !== _v) "+c+".innerHTML = _v");break;case"value":if("checkbox"==b.type)b.getAttribute("name")?h.push(o+c+".checked = "+a+".indexOf("+c+".value) > -1"):h.push(o+c+".checked = "+a);else if("radio"==b.type)b.getAttribute("name")?h.push(o+c+".checked = "+a+" == "+c+".value"):h.push(o+c+".checked = "+a);else if("file"==b.type){let b=a.indexOf(":");0<=b&&(m=a.substring(b+1),a=a.substring(0,b))}else h.push(o+c+".value = "+a);let n="change";("TEXTAREA"===b.tagName||"range"===b.type)&&(n="input");let p=n+"_"+uniqueID();g.push(d+".dataset.event_"+n+" = '"+p+"'"),j.push({elemId:void 0===e?d:e,eventType:n,handlerEventCheck:"  if (e.target.dataset.event_"+n+" !== '"+p+"') return;",handlerName:p,handlerCode:"file"===b.type?a+"=e.target.files[0];importData(e.target, ()=>{_mainInstance.controller({})}, "+m+")":a+"=typedReturn(e.target,"+a+");",forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContextString(b)+";",deferredUpdate:"file"===b.type});break;case"style":h.push("_v=`"+a+"`;if ("+c+".getAttribute('style') !== _v) "+c+".setAttribute('style',  _v)");break;case"class":const q=a.split(";");for(const a of q){let b,d;0<=a.indexOf(":")?(b=a.substring(0,a.indexOf(":")),d=a.substring(a.indexOf(":")+1)):b=d=a,h.push(c+".classList.toggle('"+b+"', "+d+")")}break;case"if":{let[d,e]=parseIfExpression(a);e?h.push(c+".classList.toggle('"+e+"', "+d+")"):(h.push("_v=("+a+"?'':'none');"),h.push("if ("+c+".style.display!==_v) "+c+".style.display=_v;")),b.dataset.for||void 0===b.dataset.if||h.push("if ("+parseIfExpression(b.dataset.if)[0]+") {")}break;case"action":{let c="click_"+uniqueID();g.push(d+".dataset.event_click = '"+c+"'"),j.push({elemId:void 0===e?d:e,eventType:"click",handlerEventCheck:"  if (e.target.dataset.event_click !== '"+c+"') return;",handlerName:c,handlerCode:a,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContextString(b)+";"})}break;case"for":void 0===e&&(e=c),void 0!==b.dataset.if&&0<b.children.length&&(h.push(o+"if ("+parseIfExpression(b.dataset.if)[0]+") {"),o="  "+o);let r=a.substring(0,a.indexOf(":")),s=a.substring(a.indexOf(":")+1),t="_arr_"+uniqueID();isNaN(s)?h.push(o+"let "+t+" = (typeof ("+s+") !== \"number\"?"+s+": new Array(parseInt("+s+")))"):h.push(o+"let "+t+" = new Array(parseInt("+s+"))"),h.push(o+"updateForChildren("+c+","+t+")");let u="rkn_forElem_"+uniqueID(),v="rkn_counter_"+uniqueID();h.push(o+"let "+v+" = 0"),h.push(o+"for (let "+u+" of "+c+".children){"),h.push(o+"if ("+v+">="+t+".length) break;"),h.push(o+"let "+r+"= {index:"+v+", item:"+t+"["+v+"]}");let w=0;for(let a of b.children)buildClasses(!1,b.children[w],u,d+".children["+w+"]",e,f,g,h,j,k),w++;h.push(o+v+"+=1"),h.push(o+"}// End loop "+u),void 0!==b.dataset.if&&0<b.children.length&&(o=o.substring(2),h.push(o+"}"));break;case"calc":h.unshift(b.textContent.trim());break;case"component":if(e=void 0,!generatedClass[a]){let c=[],d=[],g=[];if(buildClasses(!0,b,"this.root","this.root",e,f,c,d,g,k),void 0===b.dataset.for){let a=0;for(let h of b.children){buildClasses(!1,h,"this.root.children["+a+"]","this.root.children["+a+"]",e,f,c,d,g,k),a++}void 0!==b.dataset.if&&d.push("}")}const[h,i]=generateComponentClass(a,c,d,g);k.push(...i),f.push(...h),f.push(`classRegistry['${a}']=${a}`),generatedClass[a]=!0}g.push(`    ${d}.rkn_class = new ${a}(${d})`),h.push("    {");let i=[];for(let a of Object.keys(b.dataset))if(a.startsWith("arg")||a.startsWith("bind")){let c=a.substring(3).toLowerCase();a.startsWith("bind")&&(c=a.substring(4).toLowerCase());let e=b.dataset[a];/^[a-zA-Z_$][0-9a-zA-Z_$/.]*$/.test(e)?(h.push("      let "+c+" = (typeof "+e+"!== 'undefined'?"+e+":'"+e+"')"),a.startsWith("bind")&&g.push(o+d+".addEventListener('"+c+"', (e) => {"+e+" = e.detail.value})")):isNaN(e)?h.push("      let "+c+" = `"+e+"`"):h.push("      let "+c+" = "+e),i.push(`${c}`)}h.push(`      ${c}.rkn_class.controller({${i.join(",")}})`),h.push("    }");break;case"rest":let x=a.substring(0,a.indexOf(":")),y=a.substring(a.indexOf(":")+1),z="",A=y.indexOf(":");0<A&&!y.startsWith("http")&&(z="."+y.substring(0,A),y=y.substring(A+1));let B="{}";b.dataset.restOptions&&(B=b.dataset.restOptions),h.push("    processRestCall("+c+",`"+y+"`, "+B+", (js)=>{"+x+"=js"+z+";_mainInstance.controller({})})");break;default:if(l.startsWith("attr")){let b=l.substring(4).toLowerCase();booleanAttrs.includes(b.toLowerCase())?h.push("if ("+a+"){"+c+".setAttribute('"+b+"', `"+a+"`)}else{"+c+".removeAttribute('"+b+"')}"):h.push("if ("+c+".getAttribute('"+b+"') !== `"+a+"`) "+c+".setAttribute('"+b+"', `"+a+"`)")}else if(l.startsWith("on")){let c=l.substring(2).toLowerCase(),f=a,h=c+"_"+uniqueID();g.push(d+".dataset.event_"+c+" = '"+h+"'"),j.push({elemId:void 0===e?d:e,eventType:c,handlerEventCheck:"  if (e.target.dataset.event_"+c+" !== '"+h+"') return;",handlerName:h,handlerCode:f,forContext:"let ctxIdx = indexesInForAncestors(e.target);"+getEventContextString(b)+";"})}}}if(!b.dataset.component&&!b.dataset.for){let a=0;for(let i of b.children)buildClasses(!1,i,c+".children["+a+"]",d+".children["+a+"]",e,f,g,h,j,k),a++;b.dataset.if!==void 0&&h.push("}")}}const processComponentReferences=a=>{if("TEMPLATE"!=a.tagName&&"component"in a.dataset){let b=getComponent(a.dataset.component);if(null!=b){let c=b.querySelector("[data-slot]");if(null!=c&&0<a.childNodes.length){let b=c;for(let d,e=a.childNodes.length-1;0<=e;e--)d=a.childNodes[e],c.parentElement.insertBefore(d,b),b=d;c.parentElement.removeChild(c)}for(let c of a.getAttributeNames())null==b.getAttribute(c)?null!=a.getAttribute(c)&&b.setAttribute(c,a.getAttribute(c)):((c.startsWith("data-arg")||c.startsWith("data-bind"))&&b.setAttribute(c,a.getAttribute(c)),"class"==c&&b.classList.add(a.getAttribute("class")));a.parentElement.replaceChild(b,a)}}else for(let b of a.children)processComponentReferences(b)};let componentRegistry={},classRegistry={},generatedClass={};const getComponent=a=>{let b=componentRegistry[a];if(b===void 0){let c=document.querySelector(`template[data-component='${a}']`);if(null==c||null==c.content||0==c.content.children.length)return console.error(`Component ${a}: no component definition found`),null;for(let a of c.content.children)if("STYLE"!==a.tagName&&"SCRIPT"!==a.tagName){b=a;break}processComponentReferences(b),b.setAttribute("data-component",a),componentRegistry[a]=b}let c=b.cloneNode(!0);return c};function generateComponentClass(a,b,c,d){let e=document.querySelector("template[data-component='"+a+"']"),f=[];f.push(`class ${a} extends rkn_base{`),f.push("  constructor(root) {"),f.push("  super()"),f.push("    this.root = root;"),f.push(...b);const[g,h]=getStateVars(e);g.push("root"),f.push(...h);for(let e of g)f.push(`    this.${e} = ${e}`);for(let e of d)f.push("    "+e.elemId+".addEventListener('"+e.eventType+"', event => this."+e.handlerName+"(event))");f.push("  }"),f.push("  static createInstance(elem) {"),f.push(`    return new ${a}(elem);`),f.push("  }");const i=getInitParams(e,"arg"),j=getInitParams(e,"bind"),k=j.map(a=>a.substring(0,a.indexOf("="))),l=[...i,...j],m=l.map(a=>a.substring(0,a.indexOf("="))),[n,o]=getMethods(e,g,l);f.push(...o),f.push(`  controller({${l.join(",")}}) {`);for(let e of g)f.push(`    let ${e} = this.${e}`);for(let e of n)f.push(e);f.push(...getScript(e)),0<c.length&&f.push(`    let _v`),f.push(...c);for(let e of l){let a=e.substring(0,e.indexOf("="));f.push("    this."+a+" = "+a)}for(let e of g)f.push(`    this.${e} = ${e}`);f.push("  }");for(let e of d){f.push("  "+e.handlerName+"(e) {"),f.push("  "+e.handlerEventCheck);for(let a of g)f.push(`    let ${a} = this.${a}`);for(let a of m)f.push("    let "+a+" = this."+a);for(let a of n)f.push(a);f.push("    "+e.forContext),f.push("    "+e.handlerCode);for(let a of k)f.push("    if ("+a+"!==this."+a+") root.dispatchEvent(new CustomEvent('"+a+"', {detail:{value:"+a+"}}))");for(let a of g)f.push(`    this.${a} = ${a}`);e.deferredUpdate||f.push("    _mainInstance.controller({})"),f.push("  }")}return f.push("}"),[f,getStyle(e)]}function getStateVars(a){let b=[],c=[];if(a){let d=a.content.querySelector("script");if(null!=d&&!d.hasAttribute("data-calc")&&0<d.childNodes.length){let a=d.textContent.split(/\r?\n/);for(let d of a){if(d=d.trim(),d.startsWith("function"))break;if(""==d||!d.startsWith("let"))continue;c.push("    "+d);let a=d.split(/=? /),e=a[1];b.push(e)}}}return[b,c]}function getMethods(a,b,c){let d=[],e=[],f=!0;if(a){let g=a.content.querySelector("script");if(null!=g&&!g.hasAttribute("data-calc")&&0<g.childNodes.length){let a=g.textContent.split(/\r?\n/);for(let g of a){if(g=g.trim(),g.startsWith("function")){f=!1,g=g.substring(8);let a=g.substring(0,g.indexOf("(")).trim(),h=g.substring(a.length+1,g.indexOf(")")+1).trim();e.push("    "+g);for(let a of b)e.push(`    let ${a} = this.${a}`);for(let a of d)e.push("    "+a);for(let a of c){let b=a.substring(0,a.indexOf("="));e.push("    let "+b+" = this."+b)}d.push(`let ${a} = ${h}=>this.${a}${h}`);continue}f||e.push("    "+g)}}}return[d,e]}function getInitParams(a,b){let c=[];if(a)for(let d of Object.keys(a.dataset))if(d.startsWith(b)){let e=d.substring(b.length).toLowerCase(),f=a.dataset[d];e+=""==f?"=undefined":`=${isNaN(f)?"'"+f+"'":f}`,c.push(e)}return c}function getStyle(a){if(a&&a.content.querySelector("style")){let b=a.content.querySelector("style");if(null!=b&&b.textContent){let c=a.dataset.component,d=b.textContent.split(/\r?\n/);for(let a=0;a<d.length;a++)if(0<d[a].indexOf("{")){let b=d[a].indexOf(":host");0<=b&&(d[a]=d[a].substring(b+5)),d[a]=`[data-component=${c}]`+d[a]}return d}}return[]}function getScript(a){if(a&&a.content.querySelector("script[data-calc]")){let b=a.content.querySelector("script[data-calc]");if(null!=b&&b.textContent){let a=b.textContent.split(/\r?\n/);return a}}return[]}function getEventContextString(a,b){"undefined"==typeof b&&(b={idx:0});let c="",d=a.parentElement;return null!=d&&(c=getEventContextString(d,b),"undefined"!=typeof d.dataset.for)?c+getForContextString(d,"ctxIdx["+b.idx++ +"]"):c}function getForContextString(a,b){let c=a.dataset.for,d=c.substring(0,c.indexOf(":")),e=c.substring(c.indexOf(":")+1),f="let "+d+"= {index:"+b+"};";return f+="if (typeof ("+e+") !== 'number' && typeof ("+e+") !== 'undefined')"+d+"['item'] = "+e+"["+b+"];",f}const parseIfExpression=a=>{let b=null,c=a;return 0<=a.indexOf(":")&&(b=a.substring(0,a.indexOf(":")),c=a.substring(a.indexOf(":")+1)),[c,b]};function processRestCall(a,b,c,d){if(c&&"undefined"!=typeof c.fetch){if(!1===c.fetch)return;c.fetch=!1}else{if(typeof a.dataset.url!==void 0&&a.dataset.url===b)return;a.dataset.url=b}a.classList.add("reken-rest-busy"),a.classList.remove("reken-rest-error","reken-rest-done");let e=!1;fetch(b,c).then(a=>{if(!a.ok&&304===!a.status)throw new Error(`Network response was not ok, code ${a.status} - ${a.statusText}`);if(304===a.status)return void(e=!0);if(c.response=a,c.transformer){let b=Promise.resolve(a.text());return b.then(a=>c.transformer(a,c))}return a.json()}).then(b=>{e||d(b),a.classList.add("reken-rest-done")}).catch(b=>{throw a.classList.add("reken-rest-error"),b}).finally(()=>{a.classList.remove("reken-rest-busy")})}function typedReturn(a,b){switch(a.type){case"checkbox":return a.getAttribute("name")?(a.checked&&0>b.indexOf(a.value)&&b.push(a.value),!a.checked&&-1<b.indexOf(a.value)&&b.splice(b.indexOf(a.value),1),b):a.checked;case"radio":return a.getAttribute("name")?a.value:a.checked;case"number":case"range":return a.valueAsNumber;case"file":return a.files[0];default:return a.value;}}function importData(a,b,c){let d=a.files[0],e=new FileReader;e.onload=function(f){let e=f.target.result;a.files[0].data=c?c(e,d):JSON.parse(e),b()},e.readAsText(d)}function indexesInForAncestors(a,b){"undefined"==typeof b&&(b=[]);let c=a.parentElement;return null!=c&&(indexesInForAncestors(c,b),"undefined"!=typeof c.dataset.for&&b.push(indexOf(c.children,a))),b}function indexOf(a,b){let c=0;for(let d of a){if(d===b)return c;c++}return-1}function updateForChildren(a,b){let c=a.children,d=c.length;if(0<d){let e=c[0];e.removeAttribute("id"),e.querySelectorAll("[id]").forEach(a=>{a.removeAttribute("id")});e.cloneNode(!0);for(let f=0;f<b.length;f++){let b;f<d?b=c[f]:(b=e.cloneNode(!0),initComponentElement(b),a.appendChild(b)),""!==c[f].style.display&&(c[f].style.display="")}for(let a=b.length;a<d;a++)"none"!==c[a].style.display&&(c[a].style.display="none")}}let initComponentElement=a=>{if(void 0!==a.dataset.component)return void(void 0===a.rkn_class&&(a.rkn_class=classRegistry[a.dataset.component].createInstance(a)));for(let b of a.children)initComponentElement(b)};var _ID=0;function uniqueID(){return"rkn"+_ID++}processComponentReferences(document.body.parentElement);{let a=[],b=["template {display:none !important;}"];if(document.body.parentElement.setAttribute("data-component","_main"),a.push("class rkn_base { dispatch(type, content){this.root.dispatchEvent(new CustomEvent(type, {detail:content}))}} "),buildClasses(!1,document.body.parentElement,"_r","_r",void 0,a,[],[],[],b),0<b.length){const a=document.querySelector("head");null==a&&(a=document.createElement("head"),document.body.parentElement.insertBefore(a,document.body));const c=document.createElement("style");c.textContent=b.join("\n"),a.appendChild(c)}a.push("let _mainInstance = _main.createInstance(document.body.parentElement)"),a.push("document.body.parentElement.rkn_class = _mainInstance"),a.push("_mainInstance.controller({})");let c=a.join("\n"),d=new Function(c);d();var element}